<!DOCTYPE html>
<html lang="ru" class="light">
  <head>
    <meta charset="utf-8" />
    <title>Холодос - мой список продуктов</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no, viewport-fit=cover"
    />
    <meta
      content="Холодос – это бот-приложение, делающее процесс похода в магазин проще, быстрее, и что самое главное, эффективнее."
      name="description"
    />
    <meta name="format-detection" content="telephone=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="MobileOptimized" content="176" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="robots" content="noindex, nofollow" />
    <link href="./favicon.ico" rel="icon" />
    <script src="https://tg.dev/js/telegram-web-app.js"></script>
    <script>
      function setThemeClass() {
        document.documentElement.className = Telegram.WebApp.colorScheme;
      }
      Telegram.WebApp.onEvent('themeChanged', setThemeClass);
      setThemeClass();
    </script>
    <link href="css/holodos.css" rel="stylesheet" />
  </head>

  <body class="holodos-bg-img">
    <main id="app" v-cloak>
      <section v-if="page === 0" class="holodos-start">
        <div class="holodos-start-item">
          <img
            src="img/bg-order.png"
            alt=""
            style="width: 200px; margin-bottom: 15px"
          />

          <button class="holodos-start-btn" @click="page += 1">Відкрити</button>
          <p>Бот агрегує список продуктів із мережі маркетів АТБ</p>
        </div>
      </section>

      <section
        v-if="page === 1"
        class=""
        style="margin-left: 80px; margin-right: 80px"
      >
        <div class="holodos-start-item">
          <button
            class="holodos-start-btn"
            style="margin-top: 10px"
            v-for="(item, index) in items"
            :key="item.category"
            @click="category = index; page += 1"
          >
            {{ item.category }}
          </button>
        </div>
      </section>

      <section v-if="page === 2" class="holodos-page holodos-items">
        <div
          class="holodos-item"
          :class="item.counter === 0 ? '' : 'selected'"
          v-for="(item, index) in items[category].products"
          :key="`${items[category].category}-${index}`"
        >
          <div
            class="holodos-item-counter"
            :style="item.counter === 0 ? '' : 'animation-name: badge-incr'"
          >
            {{ item.counter }}
          </div>
          <div class="holodos-item-photo" @click="onModal(item)">
            <picture class="holodos-item-lottie">
              <img :src="item.img" :alt="item.title" />
            </picture>
          </div>
          <div class="holodos-item-label">
            <span class="holodos-item-price">
              {{ item.price }} {{ item.priceTitle }}
            </span>
          </div>
          <div class="holodos-item-buttons">
            <button
              class="holodos-item-decr-button decr-btn button-item ripple-handler"
              @click="delCounter(item)"
            >
              <span class="ripple-mask"><span class="ripple"></span></span>
            </button>
            <button
              class="holodos-item-incr-button button-item ripple-handler"
              @click="addCounter(item)"
            >
              <span class="button-item-label"> ТАК </span>
              <span class="ripple-mask">
                <span
                  class="ripple"
                  :style="item.counter === 0 ? '' : 'transform: translate3d(4.34375px, -4px, 0px) scale3d(1, 1, 1); opacity: 0; transition-duration: var(--ripple-end-duration, 0.2s);'"
                >
                </span>
              </span>
            </button>
          </div>
        </div>
      </section>

      <section
        v-if="page === 3"
        class="holodos-page holodos-order-overview"
        style="display: block"
      >
        <div class="holodos-block" style="margin-bottom: 14px">
          <div class="holodos-order-header-wrap">
            <img
              src="img/bg-order.png"
              alt=""
              style="width: 60px; margin-right: 20px"
            />
            <div class="holodos-order-item-label">
              <div class="holodos-order-item-title">
                СПИСОК #{{ getRndInteger(1000000,9999999) }}
              </div>
              <div class="holodos-order-item-text">
                Ідеальний список для покупок
              </div>
              <div class="holodos-order-item-description">@MyHolodosBot</div>
            </div>
          </div>
          <div class="holodos-order-items"></div>
        </div>

        <div class="holodos-block">
          <div class="holodos-order-header-wrap">
            <h2 class="holodos-order-header">Ваш список</h2>
            <button
              type="button"
              class="holodos-order-edit"
              @click="page = 1"
              style="cursor: pointer; color: #fff"
            >
              ...
            </button>
          </div>

          <div class="holodos-order-items">
            <div v-for="tab in items" :key="`order-${tab.category}`">
              <template v-for="(item, index) in tab.products">
                <div
                  v-if="item.counter > 0"
                  class="holodos-order-item selected"
                >
                  <div class="holodos-order-item-photo">
                    <picture class="holodos-item-lottie">
                      <img :src="item.img" :alt="item.title" />
                    </picture>
                  </div>
                  <div class="holodos-order-item-label">
                    <div
                      class="holodos-order-item-title holodos-order-item-title-small"
                    >
                      {{ item.title }}
                      <span class="holodos-order-item-counter">
                        {{ item.counter }}x
                      </span>
                    </div>
                    <div class="holodos-order-item-description">
                      {{ tab.title }}
                    </div>
                  </div>
                  <div
                    class="holodos-order-item-price"
                    style="font-size: small"
                  >
                    {{ item.price }} {{ item.priceTitle }}
                  </div>
                </div>
              </template>
            </div>
          </div>

          <div class="holodos-order-item selected">
            <div class="holodos-order-item-photo"></div>
            <div class="holodos-order-item-label">
              <div class="holodos-order-item-title">Усього:</div>
            </div>
            <div class="holodos-order-item-price-all">₴{{ price }}</div>
          </div>
        </div>

        <div class="holodos-text-field-wrap">
          <textarea
            class="holodos-text-field holodos-block"
            rows="1"
            v-model="comment"
            placeholder="Додати коментар…"
            style="overflow: hidden visible; overflow-wrap: break-word"
          ></textarea>
          <div class="holodos-text-field-hint">
            Будь-які особливі побажання, деталі тощо.
          </div>
        </div>
      </section>

      <div class="holodos-modal" v-if="modal" @click="modal = false">
        <div class="holodos-modal-content">
          <div class="holodos-modal-card">
            <img :src="item.img" :alt="item.title" />
            <div class="holodos-modal-container">
              <h3>{{ item.title }}</h3>
              <p>{{ item.price }} {{ item.priceTitle }}</p>
            </div>
          </div>
        </div>
      </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.4"></script>
    <script src="js/holodos.js"></script>
  </body>
</html>
